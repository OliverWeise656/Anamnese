<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HNO-Anamnese und Hörtest</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div id="chatbot">
        <h1>HNO-Anamnese</h1>
        <div id="messages"></div>
        <input type="text" id="userInput" placeholder="Ihre Nachricht...">
        <button id="sendButton" onclick="sendMessage()">Senden</button>
    </div>

    <div id="tone-setting" style="display: none;">
        <h1>Ton-Einstellung</h1>
        <p>Für die folgenden Tests ist es notwendig Ihren Ton einzustellen:</p>
        <p>Nach dem Drücken von "Start" hören Sie einen Ton, stellen Sie die Lautstärke Ihres Kopfhörers oder Lautsprechers so ein, dass Sie den Ton gerade noch hören können. Wenn Sie fertig sind, drücken Sie "Stopp".</p>
        <button id="startButton">Start</button>
        <button id="stopButton" disabled>Stopp</button>
    </div>

    <div id="initial-test" style="display: none;">
        <h1 id="initial-test-heading">Sprachverständnis-Test</h1>
        <p id="initial-instructions">Drücke den Button, um den Test zu starten.</p>
        <button id="start-initial-test-button">Test starten</button>
        <div id="test-area" style="display: none;">
            <p id="audio-instruction"></p>
            <input type="text" id="answer-input">
            <button id="submit-initial-test-button">Bestätigen</button>
        </div>
        <p id="initial-test-result" style="display: none;"></p>
    </div>

    <div id="test" style="display: none;">
        <p>Hören Sie das Wort und geben Sie es ein:</p>
        <audio id="audioPlayer"></audio>
        <input type="text" id="response" placeholder="Geben Sie das Wort ein">
        <button id="nextButton">Weiter</button>
    </div>

    <div id="hearing-test" style="display: none;">
        <h1>Hörtest</h1>
        <p id="instructions">Drücken Sie den Knopf, um den Test des rechten Ohres zu starten.</p>
        <button id="start-right-test-button" onclick="startTest('right')">Rechtes Ohr testen</button>
        <div id="right-test-done" class="hidden">
            <p>Der Test für das rechte Ohr ist abgeschlossen. Drücken Sie auf "Linkes Ohr testen", um fortzufahren.</p>
            <button id="start-left-test-button" onclick="startTest('left')">Linkes Ohr testen</button>
        </div>
        <div id="test-area" class="hidden">
            <p>Drücken Sie den Knopf, sobald Sie den Ton hören:</p>
            <button onclick="heardTone()">Ton gehört</button>
        </div>
        <div id="results" class="hidden">
            <h2>Ergebnisse</h2>
            <table>
                <thead>
                    <tr>
                        <th>Frequenz (Hz)</th>
                        <th>Rechts (dB)</th>
                        <th>Links (dB)</th>
                    </tr>
                </thead>
                <tbody id="resultsTableBody"></tbody>
            </table>
            <canvas id="resultsChart"></canvas>
        </div>
    </div>

    <p id="final-result" style="display: none;"></p>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
