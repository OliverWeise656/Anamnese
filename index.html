<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprachverständnis-Test</title>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
            color: #333;
            box-sizing: border-box;
        }
        #chatbot, #tone-setting, #initial-test, #hearing-test-info, #test, #hearing-test {
            background: #fff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            padding: 30px;
        }
        h1 {
            font-size: 2em;
            margin-bottom: 20px;
        }
        p {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        .hidden {
            display: none;
        }
        .message {
            margin: 10px 0;
            padding: 12px;
            border-radius: 12px;
        }
        .user {
            background-color: #d1e7dd;
            text-align: right;
        }
        .doktor {
            background-color: #f8d7da;
            text-align: left;
        }
        .test-area {
            display: none;
        }
        input[type="text"] {
            width: calc(100% - 24px);
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 1em;
        }
        button {
            padding: 12px 24px;
            margin: 10px 0;
            border: none;
            border-radius: 8px;
            background-color: #007bff;
            color: #fff;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }
        button:hover {
            background-color: #0056b3;
            transform: scale(1.05);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th, td {
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #f8f9fa;
        }
        canvas {
            margin-top: 20px;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image-more/2.9.0/dom-to-image-more.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div id="chatbot">
        <h1><span style="color: blue;">Ihre Buchung war erfolgreich!</span></h1>
        <p>Eine Bestätigungsmail ist bereits auf dem Weg zu Ihnen.</p>
        <p>Falls Sie einen <span style="color: red;">Termin bei Dr. Weise</span> gebucht haben, bitten wir Sie, uns kurz und stichwortartig einige Fragen zu beantworten und bereits einige Tests durchzuführen. Auf diese Weise können wir Ihren Aufenthalt bei uns optimal planen.<p>(Dauer: max. 20 min.)</p>
        <p><span style="color: green;">Andernfalls können Sie den Browser nun schließen.</span></p>
        <p>Alternativ können Sie die Tests auch später über den Link in Ihrer Bestätigungsmail durchführen oder ergänzen.</p>
        <p>Falls der Patient jünger als 4 Jahre ist, brauchen Sie die Fragen nicht zu beantworten und die Tests nicht durchzuführen.</p>
        <p><span style="color: red;">Geben Sie zunächst das Alter des Patienten ein:</span></p>
        <div id="messages"></div>
        <input type="text" id="userInput" placeholder="Ihre Nachricht...">
        <button onclick="sendMessage()">Senden</button>
    </div>

    <div id="tone-setting" class="hidden">
        <h1>Ton-Einstellung</h1>
        <p>Für die folgenden Tests ist es notwendig, Ihren Ton einzustellen. Gehen Sie dazu bitte in eine ruhige Umgebung und nutzen Sie am besten einen Kopfhörer. Wenn Sie den Test mit Hörgeräten durchführen oder gemeinsam mit Ihrem Kind machen, können Sie auch den Lautsprecher Ihres Rechners verwenden, um zu hören, was Ihr Kind nachsprechen oder als gehört anzeigen soll.</p>
        <p>Nach dem Drücken von „Start“ hören Sie einen Ton. Stellen Sie die Lautstärke Ihres Kopfhörers oder Lautsprechers so ein, dass der Patient den Ton gerade noch hören kann. <p>Falls Sie ohne Kopfhörer arbeiten, stellen Sie den Ton etwas lauter ein. <p>Wenn Sie fertig sind, drücken Sie „Stopp“.</p>
        <button id="startButton">Start</button>
        <button id="stopButton" disabled>Stopp</button>
    </div>

    <div id="initial-test" class="hidden">
        <h1 id="initial-test-heading">Sprachverständnis-Test</h1></p> Tragen Sie das gehörte Wort in das dafür vorgesehene Feld ein. Wenn Sie das Wort nicht verstehen, lassen Sie das Feld bitte leer und bestätigen Sie ohne Eintrag.<p><span style="color: red;">Wichtig zu beachten: Bei den folgenden Tests ist es unmöglich, die volle Punktzahl zu erreichen. Hier werden bewusst Grenzen ausgelotet!</span><p>
        <p id="initial-instructions">Bitte drücken Sie den Button, um den Test zu starten.</p>
        <button id="start-initial-test-button">Test starten</button>
        <div id="test-area">
            <p id="audio-instruction"></p>
            <input type="text" id="answer-input">
            <button id="submit-initial-test-button">Bestätigen</button>
        </div>
        <p id="initial-test-result" class="hidden"></p>
    </div>

    <div id="hearing-test-info" class="hidden">
        <h1>Sprachverständnis im Störschall</h1>
        <p>Während dieses Tests werden Ihnen Wörter im Hintergrundrauschen vorgespielt. Ihre Aufgabe besteht darin, das gehörte Wort in das Textfeld einzugeben. Falls Sie das Wort nicht verstanden haben, lassen Sie das Feld einfach leer und bestätigen ohne Eintrag. <p>Für diesen Test können Sie die Lautstärke beliebig einstellen.</p>
        <button id="start-hearing-test-button">Test starten</button>
    </div>

    <div id="test" class="hidden">
        <h1>Sprachverständnis im Störschall</h1>
        <audio id="audioPlayer"></audio>
        <input type="text" id="response" placeholder="Ihre Antwort...">
        <button id="nextButton">Nächstes Wort</button>
    </div>

    <div id="hearing-test" class="hidden">
        <h1>Hörtest</h1>
        <div id="instructions">
            <p>Auf jeder Seite werden Sie sechs Töne hören. Zuerst wird Ihr rechtes Ohr getestet. Bitte drücken Sie den Knopf, sobald Sie einen Ton wahrnehmen.</p>
            <button onclick="startTest('right')">Rechtes Ohr Testen</button>
        </div>
        <div id="right-test-done" class="hidden">
            <p>Der Hörtest für das rechte Ohr ist abgeschlossen. Nun folgt der Test für das linke Ohr.</p>
            <button onclick="startTest('left')">Linkes Ohr Testen</button>
        </div>
        <div id="test-area">
            <button onclick="heardTone()">Ton gehört</button>
        </div>
        <div id="results" class="hidden">
            <h2>Ergebnisse</h2>
            <canvas id="resultsChart" width="400" height="200"></canvas>
        </div>
    </div>

    <div id="final-result" class="hidden"></div>
    <div id="thank-you" class="hidden">
        <h1>Herzlichen Dank für Ihre Mitarbeit.</h1>
        <p>Auf Ihrem Desktop wurden folgende PDF abgelegt: Anamnese und Testergebnisse.pdf, Diskrimination.pdf und Dichotisch.pdf . Bitte bringen Sie diese ausgedruckt zu Ihrem Besuch bei uns mit oder senden Sie diese unter dem BETREFF "TerminWeise" mit Besuchsdatum und Zeit bei uns an folgende eMail Adresse: info@hno-stuttgart.com. Auf diese Weise gewährleisten Sie einen reibungslosen Ablauf ihres Besuches bei uns!<p> Bitte beachten Sie, dass der Hörtest besonderer Interpretation bedarf und nur für den Gebrauch in unserer Praxis vorgesehen ist!</p>
    </div>

    <script src="script.js"></script>
</body>
</html>
